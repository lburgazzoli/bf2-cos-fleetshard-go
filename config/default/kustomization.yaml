namespace: cos-fleetshard-system

commonLabels:
  app.kubernetes.io/created-by: cos
  app.kubernetes.io/part-of: cos-fleetshard

images:
  - name: docker.io/apache/camel-k
    newTag: 1.11.1
  - name: quay.io/lburgazzoli/cos-fleetshard
    newTag: latest

resources:
- namespace.yaml
- ../camel-k
- ../crd
- ../rbac
- ../manager

patches:
  - target:
      group: rbac.authorization.k8s.io
      version: v1
      kind: ClusterRoleBinding
      name: ".*"
    patch: |-
      - op: replace
        path: /subjects/0/namespace
        value: "cos-fleetshard-system"
  - target:
      group: rbac.authorization.k8s.io
      version: v1
      kind: ClusterRoleBinding
      name: "camel-k-operator.*"
    patch: |-
      - op: replace
        path: /subjects/0/name
        value: "cos-fleetshard"
  - target:
      group: apiextensions.k8s.io
      version: v1
      kind: CustomResourceDefinition
      name: builds.camel.apache.org
    patch: |-
      - op: replace
        path: /metadata/name
        value: "builds.cos.bf2.dev"
      - op: replace
        path: /spec/group
        value: "cos.bf2.dev"
      - op: replace
        path: /spec/versions/0/name
        value: "v2"
  - target:
      group: apiextensions.k8s.io
      version: v1
      kind: CustomResourceDefinition
      name: camelcatalogs.camel.apache.org
    patch: |-
      - op: replace
        path: /metadata/name
        value: "camelcatalogs.cos.bf2.dev"
      - op: replace
        path: /spec/group
        value: "cos.bf2.dev"
      - op: replace
        path: /spec/versions/0/name
        value: "v2"
  - target:
      group: apiextensions.k8s.io
      version: v1
      kind: CustomResourceDefinition
      name: integrationkits.camel.apache.org
    patch: |-
      - op: replace
        path: /metadata/name
        value: "integrationkits.cos.bf2.dev"
      - op: replace
        path: /spec/group
        value: "cos.bf2.dev"
      - op: replace
        path: /spec/versions/0/name
        value: "v2"
  - target:
      group: apiextensions.k8s.io
      version: v1
      kind: CustomResourceDefinition
      name: integrationplatforms.camel.apache.org
    patch: |-
      - op: replace
        path: /metadata/name
        value: "integrationplatforms.cos.bf2.dev"
      - op: replace
        path: /spec/group
        value: "cos.bf2.dev"
      - op: replace
        path: /spec/versions/0/name
        value: "v2"
  - target:
      group: apiextensions.k8s.io
      version: v1
      kind: CustomResourceDefinition
      name: integrations.camel.apache.org
    patch: |-
      - op: replace
        path: /metadata/name
        value: "integrations.cos.bf2.dev"
      - op: replace
        path: /spec/group
        value: "cos.bf2.dev"
      - op: replace
        path: /spec/versions/0/name
        value: "v2"
  - target:
      group: apiextensions.k8s.io
      version: v1
      kind: CustomResourceDefinition
      name: kameletbindings.camel.apache.org
    patch: |-
      - op: replace
        path: /metadata/name
        value: "kameletbindings.cos.bf2.dev"
      - op: replace
        path: /spec/group
        value: "cos.bf2.dev"
      - op: replace
        path: /spec/versions/0/name
        value: "v2"
  - target:
      group: apiextensions.k8s.io
      version: v1
      kind: CustomResourceDefinition
      name: kamelets.camel.apache.org
    patch: |-
      - op: replace
        path: /metadata/name
        value: "kamelets.cos.bf2.dev"
      - op: replace
        path: /spec/group
        value: "cos.bf2.dev"
      - op: replace
        path: /spec/versions/0/name
        value: "v2"
